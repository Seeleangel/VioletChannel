# 宝塔面板部署说明

## 部署步骤

### 1. 本地构建
在上传到服务器之前，先在本地构建项目：
```bash
npm install
npm run build
```

### 2. 上传文件
将以下文件和文件夹上传到服务器（比如 `/www/wwwroot/imgexpress`）：
- `dist/` 文件夹（构建后的静态文件）
- `server.js`
- `package.json`
- `ecosystem.config.cjs`（可选，用于 PM2）

**注意：** 不要上传 `node_modules/`、`src/`、开发配置文件等

### 3. 服务器安装依赖
SSH 连接到服务器，进入项目目录：
```bash
cd /www/wwwroot/imgexpress
npm install --production
```

### 4. 宝塔面板设置

#### 方法一：使用 Node 项目管理器
1. 进入宝塔面板 → 网站 → Node项目
2. 点击"添加Node项目"
3. 填写配置：
   - **项目名称**：imgexpress
   - **项目路径**：/www/wwwroot/imgexpress
   - **启动文件**：server.js
   - **端口**：3000（或其他可用端口）
   - **运行方式**：选择 PM2
4. 点击提交

#### 方法二：手动使用 PM2
```bash
cd /www/wwwroot/imgexpress
pm2 start ecosystem.config.cjs
pm2 save
pm2 startup
```

### 5. 配置反向代理（可选）
如果想通过域名访问：
1. 在宝塔面板添加一个网站（域名）
2. 设置反向代理到 `http://127.0.0.1:3000`

### 6. 访问项目
- 直接访问：`http://服务器IP:3000`
- 通过域名：`http://你的域名.com`

## 文件说明

- `dist/` - 构建后的前端静态文件
- `server.js` - Express 服务器，用于服务静态文件
- `ecosystem.config.cjs` - PM2 进程管理配置
- `package.json` - 项目依赖配置

## 常用命令

```bash
# 查看应用状态
pm2 list

# 重启应用
pm2 restart imgexpress

# 查看日志
pm2 logs imgexpress

# 停止应用
pm2 stop imgexpress

# 删除应用
pm2 delete imgexpress
```

## 注意事项

1. 确保服务器已安装 Node.js（建议 18+ 或 20+）
2. 确保端口 3000 未被占用，或修改 PORT 环境变量
3. 如遇到权限问题，使用 `sudo` 或检查文件夹权限
4. 生产环境建议配置 HTTPS 和防火墙规则
